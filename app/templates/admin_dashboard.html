{% extends "base.html" %}

{% load static %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Admin <span style="color:#6f42c1;">Dashboard</span></h2>
    <div class="messages" onclick="closeMe()">
        {% if messages %}
            {% for message in messages %}
                <div class="alert {{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <div class="user-table">
        <h3>All Users</h3>
        <table>
            <thead>
                <tr>
                    <th>Username</th>
                    <th>Email</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.first_name }}</td>
                    <td>{{ user.last_name }}</td>
                    <td>
                        <a href="{% url 'edit_user' user.id %}">Edit</a> |
                        <a href="{% url 'delete_user' user.id %}">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="create-user-form">
        <h3>Create New User</h3>
        <form method="post" action="{% url 'create_user' %}">
            {% csrf_token %}
            <table>
                <tr>
                    <td>Username:</td>
                    <td><input type="text" name="username" required></td>
                </tr>
                <tr>
                    <td>Email:</td>
                    <td><input type="email" name="email" required></td>
                </tr>
                <tr>
                    <td>First Name:</td>
                    <td><input type="text" name="first_name"></td>
                </tr>
                <tr>
                    <td>Last Name:</td>
                    <td><input type="text" name="last_name"></td>
                </tr>
                <tr>
                    <td>Password:</td>
                    <td><input type="password" name="password1" required></td>
                </tr>
                <tr>
                    <td>Confirm Password:</td>
                    <td><input type="password" name="password2" required></td>
                </tr>
            </table>
            <div id="btn"><button type="submit">Create User</button></div>
        </form>
    </div>

    <div class="predictions-table">
        <h3>All Predictions</h3>
        <table>
            <thead>
                <tr>
                    <th>PredictionId</th>
                    <th>User</th>
                    <th>Model</th>
                    <th>Created At</th>
                </tr>
            </thead>
            <tbody>
                {% for prediction in predictions %}
                <tr>
                    <td>{{ prediction.id }}</td>
                    <td>{{ prediction.user.username }}</td>
                    <td>{{ prediction.model.model_name }}</td>
                    <td>{{ prediction.created_at }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

<script src="{% static 'js/profile.js' %}"></script>
{% endblock %}
